<!DOCTYPE html>

<head>
	<title>Air Quaily Monitoring Systems</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<!-- App Icon data -->
	<link rel="Air-Quality-Monitoring-App" href="Air-Quality-Monitoring-App.png">

	<!-- Altered <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" data -->
	<link rel="stylesheet" href="CSS/Required.css" />
	<link rel="stylesheet" href="CSS/General.css" />
	<link rel="stylesheet" type="text/css" href="CSS/Marker_Cluster.css" />

	<script charset="utf8" src="src/1.3.1.jquery.min.js"></script>

	<script src="src/1.5.1.dist.leaflet.js"></script>

	<script type='text/javascript'
		src='https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js'></script>

	<!-- Load Esri Leaflet from CDN -->
	<script src="https://unpkg.com/esri-leaflet@2.2.4/dist/esri-leaflet.js"
		integrity="sha512-tyPum7h2h36X52O2gz+Pe8z/3l+Y9S1yEUscbVs5r5aEY5dFmP1WWRY/WLLElnFHa+k1JBQZSCDGwEAnm2IxAQ=="
		crossorigin=""></script>

	<!-- Leaflet.FeatureGroup.SubGroup assets -->
	<script src="https://unpkg.com/leaflet.featuregroup.subgroup@1.0.2/dist/leaflet.featuregroup.subgroup.js"></script>

	<!-- Link and script for measure tool -->
	<link rel="stylesheet" href="https://ppete2.github.io/Leaflet.PolylineMeasure/Leaflet.PolylineMeasure.css" />

	<script src="https://ppete2.github.io/Leaflet.PolylineMeasure/Leaflet.PolylineMeasure.js"></script>

	<link rel="stylesheet" href="src/leaflet-search.css" />

	<link rel="stylesheet" href="src/leaflet-search.mobile.css" />
	<link rel="icon" href="../../favicon.ico">

	<link rel="stylesheet" href="CSS/bootstrap.css">

</head>

<body>

	<!-- Begin page content -->
	<div id="map"></div>

	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="src/jquery_1.11.1.js"></script>
	<script src="src/bootsrap.3.3.1.min.js"></script>
	<script src="src/leaflet-search.js"></script>
	<script src="src/bootstrap-timepicker.js"></script>
	<script src="src/LeafletPlayback.js"></script>
	<script src="src/time-slider.js"></script>
	<script src="src/slider_controls.js"></script>
	<script src="data/samplers.geojson.js"></script>
	<script src="data/landfills.geojson.js"></script>
	<script src="data/hydrocarbon.geojson.js"></script>
	<script src="src/demo-tracks.js"></script>

	<script>

		var map = L.map('map', {
			zoom: 14,
			center: new L.latLng(39.539, -107.885),
		}),

			geojsonmonitortOpts = {
				pointToLayer: function (feature, latlng) {
					var monitorIcon = L.icon({
						iconSize: [27, 27],
						iconAnchor: [13, 27],
						popupAnchor: [1, -24],
						iconUrl: '../images/blue-circle.png',

					});

					return L.marker(latlng, { icon: monitorIcon });
				},
				onEachFeature: function (feature, layer) {
					layer.bindPopup('<br/><b>Monitor Name:</b> &nbsp;' + feature.properties.name +
						'<br><b>County and State:</b> &nbsp;' + feature.properties.territory +
						'<br><b>Date Offline:</b> &nbsp;' + feature.properties.date_online +
						'&nbsp;<b>Date Offline:</b> &nbsp;' + feature.properties.date_offline +
						'<br/>' + '<br/>' + "<table>" +
						'<tr>' +
						'<th class="text-center"><b>Data Table</b></th>' +
						'<th class="text-center">Concentration Average</th>' +
						'<th class="text-center">Weather</th>' +
						'<th class="text-center">Graphs</th>' +
						'</tr>' +
						'<tr>' +
						'<td>Daily</td>' +
						'<td>Other</td>' +
						'<td>' + feature.properties.tempatures_gra + '</td>' +
						'<td>' + feature.properties.grafana + '</td>' +
						'</tr>' +
						'<tr>' +
						'<td>Weakly</td>' +
						'<td>Other</td>' +
						'<td>' + feature.properties.humity_gra + '</td>' +
						'<td>Other</td>' +
						'</tr>' +
						'<tr>' +
						'<td>Monthly</td>' +
						'<td>Other</td>' +
						'<td>Other</td>' +
						'<td>Other</td>' +
						'</tr>' +
						'<tr>' +
						'<td>Yearly</td>' +
						'<td>Other</td>' +
						'<td>Other</td>' +
						'<td>' + feature.properties.graphs + '</td>' +
						'</tr>' +
						"</table>"
					);
				}
			};

		var monitorlayer = L.layerGroup([
			L.geoJson(Samplers, geojsonmonitortOpts)
		])
			.addTo(map);

		geojsonsourceOpts = {
			pointToLayer: function (feature, latlng) {
				var sourceIcon = L.icon({
					iconSize: [27, 27],
					iconAnchor: [13, 27],
					popupAnchor: [1, -24],
					iconUrl: '../images/orange-circle.png',

				});

				return L.marker(latlng, { icon: sourceIcon });
			},
			onEachFeature: function (feature, layer) {
				layer.bindPopup('<br/><b>Name:</b> &nbsp;' + feature.properties.name +
					'<br><b>Source Type:</b> &nbsp;' + feature.properties.variety +
					'<br><b>Status:</b> &nbsp;' + feature.properties.status +
					'<br><b>Operator:</b> &nbsp;' + feature.properties.operator +
					'<br><b>Spud Date:</b> &nbsp;' + feature.properties.date_spud +
					'&nbsp;<b>Shut-in Date:</b> &nbsp;' + feature.properties.date_shut_in +
					'<br><b>Location:</b> &nbsp;' + feature.properties.location +
					'<br/>' + '<br/>' + "<table>" +
					'<tr>' +
					'<th class="text-center">Casing Depths</th>' +
					'<th class="text-center">Leak Reports</th>' +
					'<th class="text-center">Other</th>' +
					'<tr>' +
					'<td>' + feature.properties.casing_depths + '</td>' +
					'<td>' + feature.properties.leak_reports + '</td>' +
					'<td>' + feature.properties.other + '</td>' +
					"</table>"
				);
			}
		};

		var sourcelayer = L.layerGroup([
			L.geoJson(hydrocarbon_wells, geojsonsourceOpts)
		])
			.addTo(map);

		function style(feature) {
			return {
				color: "black",
				weight: 2,
				opacity: 0.7,
				fill: true,
				fillColor: "maroon",
				fillOpacity: 0.3,
				smoothFactor: 0.5,
				dashArray: '5,5',
			};
		}

		function onEachFeature(feature, layer) {
			// feature.properties.popupContent is required for popup
			if (feature.properties && feature.properties.popupContent) {
				layer.bindPopup('<br/><b>Name:</b> &nbsp;' + feature.properties.name +
					'<br><b>Address:</b> &nbsp;' + feature.properties.address +
					'<br><b>Date Opened:</b> &nbsp;' + feature.properties.date_open +
					'&nbsp;<b>Date Closed:</b> &nbsp;' + feature.properties.date_shut_down +
					'<br/>' + '<br/>' + "<table>" +
					'<tr>' +
					'<th class="text-center">data</th>' +
					'<th class="text-center">data</th>' +
					'<th class="text-center">data</th>' +
					'<tr>' +
					'<td>N/A</td>' +
					'<td>N/A</td>' +
					'<td>N/A</td>' +
					"</table>");
			}
		}

		var landfillmarkers = L.geoJson(landfills, {
			style: style,
			onEachFeature: onEachFeature
		}).addTo(map);

		L.control.search({
			layer: monitorlayer,
			initial: false,
			propertyName: 'name',
			buildTip: function (text, val) {
				var type = val.layer.feature.properties.amenity;
				return '<a href="#" class="' + type + '">' + text + '<b>' + type + '</b></a>';
			}
		})
			.addTo(map);

	</script>

	<div id="basemaps-wrapper" class="leaflet-bar">
		<select name="basemaps" id="basemaps" onChange="changeBasemap(basemaps)">
			<option value="Topographic">Topographic</option>
			<option value="Streets">Streets</option>
			<option value="Imagery">Imagery</option>
			<option value="ImageryClarity" selected>Imagery (Clarity)</option>
			<option value="ImageryFirefly">Imagery (Firefly)</option>
			<option value="Gray">Gray</option>
			<option value="DarkGray">Dark Gray</option>
			<option value="ShadedRelief">Shaded Relief</option>
		</select>
	</div>
	</head>

</body>

<script type="text/javascript">

	//create esri layers and selector

	var layer = L.esri.basemapLayer('Imagery').addTo(map);
	var layerLabels = L.esri.basemapLayer('ImageryLabels');
	map.addLayer(layerLabels);

	function setBasemap(basemap) {
		if (layer) {
			map.removeLayer(layer);
		}

		layer = L.esri.basemapLayer(basemap);

		map.addLayer(layer);

		if (layerLabels) {
			map.removeLayer(layerLabels);
		}

		if (basemap === 'ShadedRelief' ||
			basemap === 'Oceans' ||
			basemap === 'Gray' ||
			basemap === 'DarkGray' ||
			basemap === 'Terrain'
		) {
			layerLabels = L.esri.basemapLayer(basemap + 'Labels');
			map.addLayer(layerLabels);
		} else if (basemap.includes('Imagery')) {
			layerLabels = L.esri.basemapLayer('ImageryLabels');
			map.addLayer(layerLabels);
		}
	}

	function changeBasemap(basemaps) {
		var basemap = basemaps.value;
		setBasemap(basemap);
	}


	var overlayMaps = {
		"Monitors": monitorlayer,
		"Hydrocarbon Production": sourcelayer,
		"Landfills": landfillmarkers
	};

	L.control.layers(null, overlayMaps).addTo(map);

</script>

</body>

</html>